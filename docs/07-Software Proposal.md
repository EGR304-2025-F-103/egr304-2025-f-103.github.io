---
title: Team Software Design
---

## Description

The purpose of this page is to visualize the overall software process of each subsystem and how they will interact with each other. The diagram below is an Activity Diagram using UML (Unified Modeling Language) symbolism. The black circle is the start of each subsystem's process. The rounded-rectangle shapes represent actions performed by the software. The diamond shapes represent decisions made in the software based on logic. Solid lines between shapes represent the flow inside each subsystem's software. Dashed lines represent information being shared between subsystems.

## UML Activity Diagram

![Software Diagram](<image/Team103SoftwareDesign.drawio.png>)

<center> [Download .drawio file](Documents/System_Program.drawio) </center>

## Software Connections

### **Motor**

The motor is the brains of the door. It will take each sensor's information in 1/0 and with a combination of 1/0 will determine if it should move forwards, backwards, or stop.

After the initial calibration, the motor will stay on waiting for a input from one of the IR sensors. Once it gets that input it will start moving based on which IR sensor gave it the input. Once moving, the motor will give each sensor a 1/0 that activates their loops. The motor then constantly waits to see if there is a different input given that would tell it to stop or move in the opposite direction. This continues until the door is fully closed.

### **IR Distance Sensors**

The distance sensing subsystem is the equivalent of eyes for the system. It is crucial to basic functioning of the system and also the main line of defense in terms of preventative safety measures. It checks it's analog values against the analog values of the rotary encoder subsystem(RES) and sends a binary signal to the motor subsytem(MS) based on the results.

- Upon initial powering of the product, the subsystem waits for a signal from the RES to begin calibration. During calibration, it receives analog values from the RES as the door opens/closes and creates an array of these values matching to the IR detectors' own analog values. The subsystem then goes into "standby mode".

- In "standby mode" the subsystem is checking if the array of values has any discrepancies (there is someone approaching the sensor) and also if the calibration signal is being received. If the calibration signal is received, the subsystem clears the arrays and repeats calibration. If there are array discrepancies, the subsystem goes into "activation mode".

- During "activation mode", the subsystem sends a digital activation signal telling the MS to begin opening the door. The subsystem then continues checking for array value discrepancies (something unexpected is in the path of the door). If discrepancies are found at any point, the subsystem sends a digital alert signal to the MS telling it to stop movement until the discrepancies are resolved, at which point it resumes "activation mode". If no discrepancies are found, the subsystem sends no signals externally as the door opens and closes, then returns to "standby mode".

### **Flex Sensor**

The flex sensor subsystem acts as the “muscle feedback” of the system. Its primary purpose is to confirm that the physical motion of the door matches the expected motion generated by the motor and rotary encoder. It is also a secondary safety layer that detects unusual resistance, mechanical detachment, or blockage in the door’s motion.

- Upon startup, the subsystem waits for a calibration signal from the rotary encoder subsystem (RES). During calibration, the flex sensor records its analog bend values at every 10° interval of the door’s motion. These values are stored in an array and used as the reference profile for normal door movement.

- Once calibration is complete, the subsystem enters "monitor mode." In this mode, it constantly compares live flex readings with the stored calibration array. If the current flex reading matches the expected value within an acceptable threshold, the subsystem does nothing and allows normal movement.

- If the flex data becomes inconsistent with the expected values—indicating obstruction, stalled motion, or motor-door detachment—the subsystem sends an emergency stop signal to the Motor Subsystem (MS). This prevents the motor from forcing the door against resistance and causing damage or injury.

If the Motor Subsystem enters pause mode due to this alert, the flex subsystem continues monitoring new readings. Once readings fall back within the safe range, it clears the alert and allows the motor to resume operation under MS control.

### **Rotary Encoder**
The Rotary Encoder Subsystem manages door position tracking and system calibration. The process begins at the initialization stage, where all encoder inputs are configured, and the system waits for the startup button to be pressed. This ensures that calibration only starts when the user or main controller signals readiness.

- Once the button is pressed, the subsystem starts the calibration process. During the calibration, the encoder defines reference points corresponding to the minimum and maximum angles of the door’s movement. These limits establish a range that will later be used to calculate and verify the door’s real time angle.

- After the calibration, the subsystem continuously reads the signals from Channel A and Channel B of the rotary encoder. These two signals are 90° out of phase, which allows the software to determine both direction (opening or closing) and movement (whether the door is in motion).

- If the door is detected as moving, the subsystem increments or decrements the internal counter depending on the direction, effectively tracking the door’s current position in encoder counts. This count is then converted into an angle (θ) that represents the door’s exact position.

- The software then checks if θ is outside the established calibration limits.

    - If θ <= minimum angle, the door closed flag is activated.
    - If θ >= maximum angle, the door open flag is activated.
    - If θ is within range, both flags are cleared.

- Once the status is determined, the subsystem sends both the door status flags and the calculated θ value to the Motor Subsystem. This allows the motor control logic to know exactly where the door is and when to stop movement for safety or accuracy.

Finally the process loops allowing continuous monitoring as long as the system remains active. The Continue Running decision ensures that the subsystem can safely exit or re-enter calibration as needed during testing.

## Summary

Each software subsystem has two main stages to ensure safety to the user. The subsystems have to undergo calibration, then during regular operation they must communicate with each other based on changes in their environment. The calibration is lead by the rotary encoder where it sends signals to the flex sensor and IR sensors. This signal is sent every 10 degrees. After each signal the sensors record analog data and store it as a variable. This happens until the rotary encoder reaches 90 degrees. When the door opens and closes, at each degree change the subsystems confirm that their current position is similar to the position from the calibration.

Next, the sensing of objects in front or behind the door. The IR sensors read if there is a user on either side of the door. If there is, the IR sensor sends a signal to the motor. The motor then takes that signal and starts to open the door. If there is something in the way, the IR sensors see it and send another signal to the motor. If the IR sensor does not see an obstacle, the flex sensor reads that it is flexing but that the flex is too much or too little for free motion of the door and sends a signal to the door. If either of these events happen the motor then stops and waits for further instruction. Depending on the instruction, the door moves back to its previous position or continues to open. This works while it is closing as well.

This process allows the product to directly satisfy the following product requirements:
- 2.1 - The product must open a door at least 90 degrees.
- 2.2 - The sensor must spot a person at 3 feet and open within 1 second.
- 3.1 - A first time user must be able to set it up in under 30 minutes.
- 6.1 - The force for pushing or pulling upen interior swinging egress doors shall not exceed 5 pounds (22N).
- 6.2 - The automatic door will not close if something is blocking the door frame.

## Version 2.0

If we were to create a new version of our software in the future, there are a few things that could be improved upon:

### **Door Rotation Amount**

Rather than have the door open 90 degrees no matter what, we could implement a feature for the door to open to a different amount based on environment/user preference. The first way to do this would be creating a user interface through which the user could specify the amount they would like the door to rotate during setup. The rotary encoder subsytem would store this value and set it as the "fully open" point for the whole system. The second option would be to add an additional line of code in the distance-sensing subsystem's calibration phase. This line would periodically check whether the distance to the wall on the opening face of the door was less than or equal to a certain value (e.g., 2 inches). If true, the subsystem would communicate this to the motor subsystem and rotary encoder subsystem. The motor would then stop and the rotary subsystem would set its current rotational value as the "fully open" point for the whole system.

This feature would be useful because not every door opens to an exact right angle. It would allow users to have more customization of the product. It would also add safety to the product in case there was an object in between the door and the wall during calibration.

### **Sensor Check Interval**

For the current version of the software, we had the sensors store data at every 10 degrees of door rotation. This was for the sake of simplicity and to conserve processing power during the prototype version of our product. For the market product however, we would reduce this interval to as small as functionally possible in order to maximize the speed of reaction between sensing an obstacle and stopping the motor.

As stated several times throughout this website, safety is our number one priority with this project and this improvement would lower the risk of someone/something being struck by the door.

### **Door Close Delay**

After fully opening, the software currently causes the door to begin closing immediately once nothing is seen by the distance-sensing subsystem on the closing face of the door. While this seems fine in practice, it could cause the door to begin closing too early if a second user is attempting to walk through the doorway. Although the system would then sense this person and stop the motor, the door might be partially closed at this point which would be inconvenient for the user. Additionally, users might prefer the door to stay open for a while in case they will be leaving the room soon after entering.

One way to solve this would be to once again use a user interface during calibration which asks the user how long they would like the door to remain open before closing. This value would then be given to the motor subsystem which would store it and use it as a delay during normal operation. Another solution would be to have the door begin reopening if the sensor on the closing face of the door detects an obstacle while the door is closing.

### **Conclusion**

While the software in its current state provides the functionality we set out to create, these improvements would make the system even more ideal. The additional functionality would improve safety, customization, and convenience while likely making the product more competitive and profitable.