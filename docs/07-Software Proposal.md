---
title: Team Software Design
---

## Description

The purpose of this page is to visualize the overall software process of each subsystem and how they will interact with each other. The diagram below is an Activity Diagram using UML (Unified Modeling Language) symbolism. The black circle is the start of each subsystem's process. The rounded-rectangle shapes represent actions performed by the software. The diamond shapes represent decisions made in the software based on logic. Solid lines between shapes represent the flow inside each subsystem's software. Dashed lines represent information being shared between subsystems.

## UML Activity Diagram

![Software Diagram](<image/Team103SoftwareDesign.drawio.png>)

<center> [Download .drawio file](Documents/System_Program.drawio) </center>

## Software Connections

### **Motor**

The motor is the brains of the door. It will take each sensor's information in 1/0 and with a combination of 1/0 will determine if it should move forwards, backwards, or stop.

After the initial calibration, the motor will stay on waiting for a input from one of the IR sensors. Once it gets that input it will start moving based on which IR sensor gave it the input. Once moving, the motor will give each sensor a 1/0 that activates their loops. The motor then constantly waits to see if there is a different input given that would tell it to stop or move in the opposite direction. This continues until the door is fully closed.

### **IR Distance Sensors**

The distance sensing subsystem is the equivalent of eyes for the system. It is crucial to basic functioning of the system and also the main line of defense in terms of preventative safety measures. It checks it's analog values against the analog values of the rotary encoder subsystem(RES) and sends a binary signal to the motor subsytem(MS) based on the results.

- Upon initial powering of the product, the subsystem waits for a signal from the RES to begin calibration. During calibration, it receives analog values from the RES as the door opens/closes and creates an array of these values matching to the IR detectors' own analog values. The subsystem then goes into "standby mode".

- In "standby mode" the subsystem is checking if the array of values has any discrepancies (there is someone approaching the sensor) and also if the calibration signal is being received. If the calibration signal is received, the subsystem clears the arrays and repeats calibration. If there are array discrepancies, the subsystem goes into "activation mode".

- During "activation mode", the subsystem sends a digital activation signal telling the MS to begin opening the door. The subsystem then continues checking for array value discrepancies (something unexpected is in the path of the door). If discrepancies are found at any point, the subsystem sends a digital alert signal to the MS telling it to stop movement until the discrepancies are resolved, at which point it resumes "activation mode". If no discrepancies are found, the subsystem sends no signals externally as the door opens and closes, then returns to "standby mode".

### **Flex Sensor**

The flex sensor subsystem acts as the “muscle feedback” of the system. Its primary purpose is to confirm that the physical motion of the door matches the expected motion generated by the motor and rotary encoder. It is also a secondary safety layer that detects unusual resistance, mechanical detachment, or blockage in the door’s motion.

- Upon startup, the subsystem waits for a calibration signal from the rotary encoder subsystem (RES). During calibration, the flex sensor records its analog bend values at every 10° interval of the door’s motion. These values are stored in an array and used as the reference profile for normal door movement.

- Once calibration is complete, the subsystem enters "monitor mode." In this mode, it constantly compares live flex readings with the stored calibration array. If the current flex reading matches the expected value within an acceptable threshold, the subsystem does nothing and allows normal movement.

- If the flex data becomes inconsistent with the expected values—indicating obstruction, stalled motion, or motor-door detachment—the subsystem sends an emergency stop signal to the Motor Subsystem (MS). This prevents the motor from forcing the door against resistance and causing damage or injury.

If the Motor Subsystem enters pause mode due to this alert, the flex subsystem continues monitoring new readings. Once readings fall back within the safe range, it clears the alert and allows the motor to resume operation under MS control.

### **Rotary Encoder**
The Rotary Encoder Subsystem manages door position tracking and system calibration. The process begins at the initialization stage, where all encoder inputs are configured, and the system waits for the startup button to be pressed. This ensures that calibration only starts when the user or main controller signals readiness.

- Once the button is pressed, the subsystem starts the calibration process. During the calibration, the encoder defines reference points corresponding to the minimum and maximum angles of the door’s movement. These limits establish a range that will later be used to calculate and verify the door’s real time angle.

- After the calibration, the subsystem continuously reads the signals from Channel A and Channel B of the rotary encoder. These two signals are 90° out of phase, which allows the software to determine both direction (opening or closing) and movement (whether the door is in motion).

- If the door is detected as moving, the subsystem increments or decrements the internal counter depending on the direction, effectively tracking the door’s current position in encoder counts. This count is then converted into an angle (θ) that represents the door’s exact position.

- The software then checks if θ is outside the established calibration limits.

    - If θ <= minimum angle, the door closed flag is activated.
    - If θ >= maximum angle, the door open flag is activated.
    - If θ is within range, both flags are cleared.

- Once the status is determined, the subsystem sends both the door status flags and the calculated θ value to the Motor Subsystem. This allows the motor control logic to know exactly where the door is and when to stop movement for safety or accuracy.

Finally the process loops allowing continuous monitoring as long as the system remains active. The Continue Running decision ensures that the subsystem can safely exit or re-enter calibration as needed during testing.

## Summary

Each software subsystem had two requirements to ensure safety to the user. The subsystems had to wait for calibration and the subsystems had to listen and respond to the motor. The calibration is lead by the rotary sensor where it sends signals to the flex sensor and IR sensors. This signal is sent every 10 degrees. After each signal, all sensors, including the encoder, record analog signal and store it as a variable. This will happen until the rotary encoder reached 90 degrees. When the door opens and closes, at each degree change the sensors will confirm that their current position is similar to the position from the calibration.

Next, the sensing of object infront or behind the door. The IR sensors will read if there is a user on either side of the door. If there is, the IR sensor will send a signal to the motor. The motor then takes that signal and starts to open the door. If there is something in the way, the IR sensor will see it and send another signal to the motor. If the IR sensor does not read it, the flex sensor will read that it is flexing but that the flex is too much or too little for free motion of the door and send a signal to the door. If either parts of this happen the motor will then stop and wait for further instruction. Depending on the instruction, the door will move back to its previous position or continue to open. This works while it is trying to close as well.
